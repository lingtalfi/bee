(function(e){if("undefined"===typeof window.babyPushPoster){function t(e){alert("babyPushPoster: "+e)}function n(e,r,i,s){if(false===s.aborted){s.onWatchProgressBefore();ajaxTim.sendMessage(e,{action:"watchProgress",fileId:r},function(o){if("data"in o&&"isEnd"in o){i(o.data);if(false===o.isEnd){setTimeout(function(){n(e,r,i,s)},s.refreshTime)}else{s.onEnd()}}else{s.aborted=true;s.onEnd();t("Implementation error: the BabyPushServer doesn't respond with the expected data (data and isEnd keys were expected)")}},{onErrorBefore:function(){s.aborted=true;s.onEnd()}})}}window.babyPushPoster=function(){this.refreshTime=1e3;this.aborted=false;this.onWatchProgressBefore=function(){};this.onEnd=function(){};var t=this;this.sendMessage=function(r,i,s,o){o=e.extend({refreshRate:1e3,onWatchProgressBefore:function(){},onEnd:function(){}},o);t.refreshTime=o.refreshRate;t.onWatchProgressBefore=o.onWatchProgressBefore;t.onEnd=o.onEnd;ajaxTim.sendMessage(r,{action:"getFileId",taskParams:i},function(e){ajaxTim.sendMessage(r,{action:"executeTask",fileId:e,taskParams:i},function(){},{onErrorBefore:function(e){t.aborted=true;o.onEnd()}});n(r,e,s,t)})};this.setRefreshTime=function(e){t.refreshTime=e};this.setOnWatchProgressBefore=function(e){t.onWatchProgressBefore=e};this.setOnEnd=function(e){t.onEnd=e}}}})(jQuery)